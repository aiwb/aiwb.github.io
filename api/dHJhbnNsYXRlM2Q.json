{"title":"Unable to stop CSS3 transition of transform by translate3d","date":"2014-09-04T13:42:37.000Z","link":"translate3d","comments":true,"tags":["css"],"categories":["代码"],"updated":"2020-04-15T21:36:20.851Z","content":"<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// for start animation</span></span><br><span class=\"line\">$(<span class=\"string\">\"#content\"</span>)</span><br><span class=\"line\">    .css(<span class=\"string\">\"-webkit-transition\"</span>, <span class=\"string\">\"all 100s\"</span>);</span><br><span class=\"line\">    .css(<span class=\"string\">\"-webkit-transform\"</span>, <span class=\"string\">\"translate(0, -900px)\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// for stop animation</span></span><br><span class=\"line\">$(<span class=\"string\">\"#content\"</span>)</span><br><span class=\"line\">    .css(<span class=\"string\">\"-webkit-transition\"</span>, <span class=\"string\">\"none\"</span>);</span><br></pre></td></tr></table></div></figure>\n\n<p>In desktop Chrome and Safari is good, but in the default browser on Android 4.1.x (SGSII, Galaxy Nexus, etc) this approach does not work - transition does not stop. Additionally, I note that the situation is only a relatively translate3d: with translate and position CSS props (e.g. “top”, “left”) it works.</p>\n<p>The transition implementation on Android 4 seems to be buggy in cases where a transitioning hardware-rendered layer is canceled by adjusting the webkitTransitionDuration to 0 (and setting webkitTransition to ‘none’ or ‘’ often implies this). This can be circumvented by using a transition duration of .001ms or similar, although this very likely still draws multiple frames.</p>\n<p>A more practical work-around on at least certain devices is to use a negative value for the webkitTransitionDelay, forcing a new transition to take effect, but choosing this value such that the transition starts directly in its finished state.</p>\n<p>Like so:</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">e.style.webkitTransition = <span class=\"string\">'-webkit-transform linear 10s'</span>;</span><br><span class=\"line\">e.style.webkitTransform = <span class=\"string\">'translate3d(100px,100px,0)'</span>;</span><br></pre></td></tr></table></div></figure>\n\n<p>now cancel 10s-long transition in 1s and reset transformation</p>\n<figure class=\"highlight\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">setTimeout(<span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    e.style.webkitTransitionDelay = <span class=\"string\">'-10s'</span></span><br><span class=\"line\">    e.style.webkitTransform = <span class=\"string\">'translate3d(0,0,0)'</span>;</span><br><span class=\"line\">&#125;, <span class=\"number\">1000</span>);</span><br></pre></td></tr></table></div></figure>\n","prev":{"title":"nodejs-note","link":"nodejs-note"},"next":{"title":"Recommend Code Style","link":"specifications-2014-08-12-Recommend-Code-Style"},"plink":"https://wuwb.github.io/translate3d/","reward":true,"copyright":{"author":"吴文斌","link":"<a href=\"https://wuwb.github.io/translate3d/\" title=\"Unable to stop CSS3 transition of transform by translate3d\">https://wuwb.github.io/translate3d/</a>","license":"自由转载-非商用-禁止演绎-保持署名 (<a href=\\\"https://creativecommons.org/licenses/by-nc-nd/4.0/\\\" rel=\\\"external nofollow\\\" target=\\\"_blank\\\">CC BY-NC-ND 4.0</a>)"}}